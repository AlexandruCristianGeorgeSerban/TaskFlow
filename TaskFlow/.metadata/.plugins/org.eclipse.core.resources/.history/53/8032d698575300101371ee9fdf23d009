package com.taskflow.action;

import com.taskflow.model.Category;
import com.taskflow.service.TaskService;
import com.taskflow.ui.MainFrame;

import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;

/** Editare categorie */
public class EditCategoryAction extends AbstractAction {
    private static final long serialVersionUID = 1L;
    private final MainFrame frame;
    private final TaskService service;

    public EditCategoryAction(MainFrame frame, TaskService service) {
        super("Edit Category");
        this.frame = frame;
        this.service = service;
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        Category c = frame.getSelectedCategory();
        if (c==null) return;
        String name = JOptionPane.showInputDialog(frame,"Category name:",c.getName());
        if (name==null||name.trim().isEmpty()) return;
        Color col = JColorChooser.showDialog(frame,"Choose category color",Color.decode(c.getColor()));
        String hex = (col==null)?c.getColor():String.format("#%02x%02x%02x",col.getRed(),col.getGreen(),col.getBlue());
        c.setName(name.trim());
        c.setColor(hex);
        service.updateCategory(c);
        frame.refreshTreeAll();
    }
}
